# MacroDroid 카카오뱅크 입금 알림 자동화 가이드 (최종판)

이 문서는 MacroDroid를 사용하여 카카오뱅크 입금 알림이 왔을 때, 보낸 사람(이름)과 입금액(숫자)을 추출하여 사용자의 서버로 HTTP 요청을 보내는 매크로의 전체 설정 과정을 담고 있습니다.

> **핵심 포인트:**
> 
> 1. 입금액은 **알림 제목**에서 가져옵니다.
>     
> 2. 보낸 사람은 **알림 내용**에서 가져옵니다.
>     
> 3. 화살표 모양이 바뀌어도 문제없는 **안전한 정규식**을 사용합니다.
>     
> 4. **동작 순서**가 가장 중요합니다.
>     

## 1단계: 트리거 (Trigger) 설정

매크로를 실행시킬 조건을 설정합니다.

1. **[트리거]** 탭에서 `+` 버튼 클릭
    
2. **[기기 이벤트]** -> **[알림]** -> **[알림 받음]** 선택
    
3. **[애플리케이션 선택]** -> **[KakaoBank]** 체크 후 확인
    
4. **[텍스트 내용 포함]** -> **포함** 선택 -> 텍스트 입력창에 `입금` 입력
    
    - _(팁: 이렇게 하면 출금이나 광고 알림에는 반응하지 않아 효율적입니다.)_
        
5. 확인 버튼 클릭
    

## 2단계: 동작 (Actions) 설정 - 순서 중요! ⭐️

데이터를 가공하고 전송하는 단계입니다. **반드시 아래 순서대로** 블록을 추가해야 합니다.

### (1) 금액 추출하기 (Extract Amount)

알림 제목(예: "모임통장 입금 5,000원")에서 숫자만 뽑아냅니다.

1. **[동작]** 탭에서 `+` 버튼 클릭
    
2. **[변수]** -> **[텍스트 편집/변형]** 선택
    
3. **[소스 텍스트]** 옆 `...` 버튼 클릭 -> **[알림]** -> **[알림 제목]** 선택 (`{not_title}`)
    
4. **[옵션]** -> **[찾아서 추출]** 선택
    
5. **[정규 표현식]** 입력: `입금\s+([0-9,]+)원`
    
6. **[대상 변수]** -> `[새 변수 추가]` -> 이름: `amount`, 형식: `문자열` -> 확인
    
7. 확인 버튼 클릭
    

### (2) 금액 쉼표 제거하기 (Format Amount)

추출한 금액(예: "5,000")에서 쉼표(,)를 지워 숫자(예: "5000")로 만듭니다.

1. **[동작]** 탭에서 `+` 버튼 클릭
    
2. **[변수]** -> **[텍스트 편집/변형]** 선택
    
3. **[소스 텍스트]** 옆 `...` 버튼 클릭 -> **[지역 변수]** -> **[amount]** 선택 (`{lv=amount}`)
    
    - _(주의: `{not_title}`이 아니라 방금 만든 변수 `{lv=amount}`여야 합니다!)_
        
4. **[옵션]** -> **[찾아서 교체]** 선택
    
5. **[정규 표현식]** 입력: `,` (쉼표 하나)
    
6. **[새 텍스트]** 입력: (비워둠 - 아무것도 입력하지 마세요)
    
7. **[대상 변수]** -> **[amount]** 선택
    
8. 확인 버튼 클릭
    

### (3) 보낸 사람 이름 추출하기 (Extract Name)

알림 내용(예: "홍길동 → 모임통장")에서 이름을 뽑아냅니다. 화살표 모양 상관없이 다 잡아내는 만능 식을 사용합니다.

1. **[동작]** 탭에서 `+` 버튼 클릭
    
2. **[변수]** -> **[텍스트 편집/변형]** 선택
    
3. **[소스 텍스트]** 옆 `...` 버튼 클릭 -> **[알림]** -> **[알림 내용]** 선택 (`{not_text}`)
    
    - _(주의: 여기는 알림 제목이 아니라 '내용'입니다!)_
        
4. **[옵션]** -> **[찾아서 추출]** 선택
    
5. **[정규 표현식]** 입력 (복사해서 붙여넣으세요): `(.*?)\s*[-=→➡➜⇒>]`
    
6. **[대상 변수]** -> `[새 변수 추가]` -> 이름: `name`, 형식: `문자열` -> 확인
    
7. 확인 버튼 클릭
    

### (4) 서버로 전송하기 (HTTP Request)

준비된 데이터를 서버로 쏘는 단계입니다. **가장 마지막에 위치**해야 합니다.

1. **[동작]** 탭에서 `+` 버튼 클릭
    
2. **[애플리케이션]** -> **[HTTP 요청]** 선택
    
3. **[요청 방법]**: `POST`
    
4. **[URL]**: 본인의 서버 주소 입력
    
5. **[헤더(Header)]**:
    
    - 이름: `Content-Type`
        
    - 값: `application/json`
        
6. **[본문(Body)]**:
    
    - 본문 유형: `application/json` (또는 `Text`)
        
    - 내용 입력:
        
        ```
        {
          "name": "{lv=name}",
          "amount": "{lv=amount}"
        }
        ```
        
7. 확인 버튼 클릭
    

## 3단계: 최종 점검 리스트

매크로 저장 전, 동작 탭의 블록 순서가 아래와 같은지 확인하세요.

1. **텍스트 편집 (추출)**: `{not_title}` 에서 `amount` 추출
    
2. **텍스트 편집 (교체)**: `{lv=amount}` 에서 `,` 제거
    
3. **텍스트 편집 (추출)**: `{not_text}` 에서 `name` 추출
    
4. **HTTP 요청**: 맨 마지막
    

## 4단계: 권한 및 배터리 설정 (필수)

매크로가 잘 돌다가 꺼지지 않게 하려면 이 설정이 필수입니다.

1. 핸드폰 설정 -> **[애플리케이션]** -> **MacroDroid**
    
2. **[배터리]** -> **[제한 없음]** (또는 배터리 최적화 제외) 선택
    
3. **[알림 접근 허용]** 권한이 켜져 있는지 확인
    

이제 모든 설정이 끝났습니다! 카카오뱅크로 1원을 보내 테스트해보세요.